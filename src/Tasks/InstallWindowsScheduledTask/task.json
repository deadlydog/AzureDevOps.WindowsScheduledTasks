{
  "id": "86718630-D8A5-128F-9C17-1C99F7C7CAD0",
  "name": "InstallWindowsScheduledTask",
  "friendlyName": "Install Windows Scheduled Task",
  "description": "Installs a Windows Scheduled Task",
"helpMarkDown": "[More Information](https://github.com/deadlydog/VSTS.WindowsScheduledTasks)",
  "category": "Utility",
  "visibility": [
    "Build",
    "Release"
  ],
  "author": "Daniel Schroeder",
  "version": {
    "Major": 0,
    "Minor": 0,
    "Patch": 24
  },
  "instanceNameFormat": "Install Windows Scheduled Task \u0027$(ScheduledTaskName)\u0027",
  "groups": [
    {
      "name": "ScheduledTaskSettings",
      "displayName": "Scheduled Task Settings",
      "isExpanded": true
    },
    {
      "name": "ServerSettings",
      "displayName": "Server Settings",
      "isExpanded": true
    }
  ],
  "inputs": [
    {
      "name": "ScheduledTaskDefinitionOptions",
      "type": "radio",
      "label": "Scheduled Task Definition",
      "required": true,
      "defaultValue": "ApplicationDirectoryPath",
      "helpMarkDown": "The working directory that the application or script should be ran from.",
      "options": {
        "ImportFromXmlFile": "Import from XML file",
        "Inline": "Inline"
      },
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "ScheduledTaskXmlFileToImportFrom",
      "type": "filePath",
      "label": "Scheduled Task XML file to import from",
      "visibleRule": "ScheduledTaskDefinitionOptions = ImportFromXmlFile",
      "required": true,
      "defaultValue": "",
      "helpMarkDown": "The XML file defining the properties to use for this Scheduled Task.\u003cbr /\u003eThis file can be obtained by creating a Scheduled Task in the Windows Task Scheduler and then exporting it. See [the help documentation](https://github.com/deadlydog/VSTS.WindowsScheduledTasks) for more info."
    },
    {
      "name": "ScheduledTaskName",
      "type": "string",
      "label": "Scheduled Task Name",
      "visibleRule": "ScheduledTaskDefinitionOptions = Inline",
      "required": true,
      "defaultValue": "",
      "helpMarkDown": "The full path of the Scheduled Task to install on the server(s).\u003cbr /\u003eIf the Scheduled Task is to be installed in a directory, the directory (or directories) must also be included in the path.\u003cbr /\u003ee.g. `MyTasks\\TaskToInstall`",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "ScheduledTaskDescription",
      "type": "string",
      "label": "Scheduled Task Description",
      "required": false,
      "defaultValue": "",
      "helpMarkDown": "A description of what the Scheduled Task does.",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "ApplicationPathToRun",
      "type": "string",
      "label": "Application or Script Path",
      "required": true,
      "defaultValue": "",
      "helpMarkDown": "The full path of the application or script that the Scheduled Task should run on the server.",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "ApplicationArguments",
      "type": "string",
      "label": "Application Arguments",
      "required": false,
      "defaultValue": "",
      "helpMarkDown": "The arguments to pass to the appliation or script.",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "WorkingDirectoryOptions",
      "type": "radio",
      "label": "Working Directory To Use",
      "required": true,
      "defaultValue": "ApplicationDirectoryPath",
      "helpMarkDown": "The working directory that the application or script should be ran from.",
      "options": {
        "ApplicationDirectory": "Application's Directory",
        "CustomDirectory": "Custom Directory"
      },
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "CustomWorkingDirectory",
      "type": "string",
      "label": "Working Directory",
      "visibleRule": "WorkingDirectoryOptions = CustomDirectory",
      "required": true,
      "defaultValue": "",
      "helpMarkDown": "The full working directory path that the application or script should be ran from.",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "ScheduleTriggerType",
      "type": "radio",
      "label": "Schedule Trigger",
      "required": true,
      "defaultValue": "DateTime",
      "helpMarkDown": "What event should trigger the Scheduled Task to run.",
      "options": {
        "DateTime": "A specific date and time",
        "AtLogOn": "When a user logs on (At Log On)",
        "AtStartup": "When the system is started (At Startup)"
      },
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "DateTimeScheduleStartTime",
      "type": "string",
      "label": "Start Time",
      "visibleRule": "ScheduleTriggerType = DateTime",
      "required": true,
      "defaultValue": "",
      "helpMarkDown": "The time that the Scheduled Task should start at. e.g. '3am', '6pm', '12pm' (noon), '12am' (midnight).",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "DateTimeScheduleFrequencyOptions",
      "type": "radio",
      "label": "Schedule Frequency",
      "visibleRule": "ScheduleTriggerType = DateTime",
      "required": true,
      "defaultValue": "Daily",
      "helpMarkDown": "How often the Scheduled Task should be ran.",
      "options": {
        "Once": "Once",
        "Daily": "Daily",
        "Weekly": "Weekly"
      },
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "DateTimeScheduleFrequencyDailyInterval",
      "type": "string",
      "label": "Daily Interval",
      "visibleRule": "DateTimeScheduleFrequencyOptions = Daily",
      "required": true,
      "defaultValue": "1",
      "helpMarkDown": "How many days between running the Scheduled Task. e.g. 1 = run every day, 2 = run every other day, 3 = run every third day, etc.",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "DateTimeScheduleFrequencyWeeklyInterval",
      "type": "string",
      "label": "Weekly Interval",
      "visibleRule": "DateTimeScheduleFrequencyOptions = Weekly",
      "required": true,
      "defaultValue": "1",
      "helpMarkDown": "How many weeks between running the Scheduled Task. e.g. 1 = run every week, 2 = run every other week, 3 = run every third week, etc.",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "ShouldDateTimeScheduleFrequencyWeeklyRunMulipleTimesAWeek",
      "type": "boolean",
      "label": "Run multiple times a week",
      "visibleRule": "DateTimeScheduleFrequencyOptions = Weekly",
      "required": true,
      "defaultValue": "false",
      "helpMarkDown": "Select to have the Scheduled Task run on specific days of the week.",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "ShouldDateTimeScheduleFrequencyWeeklyRunOnMondays",
      "type": "boolean",
      "label": "Monday",
      "visibleRule": "ShouldDateTimeScheduleFrequencyWeeklyRunMulipleTimesAWeek = true",
      "required": true,
      "defaultValue": "false",
      "helpMarkDown": "Select to have the Scheduled Task run on Mondays.",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "ShouldDateTimeScheduleFrequencyWeeklyRunOnTuesdays",
      "type": "boolean",
      "label": "Tuesday",
      "visibleRule": "ShouldDateTimeScheduleFrequencyWeeklyRunMulipleTimesAWeek = true",
      "required": true,
      "defaultValue": "false",
      "helpMarkDown": "Select to have the Scheduled Task run on Tuesdays.",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "ShouldDateTimeScheduleFrequencyWeeklyRunOnWednesdays",
      "type": "boolean",
      "label": "Wednesday",
      "visibleRule": "ShouldDateTimeScheduleFrequencyWeeklyRunMulipleTimesAWeek = true",
      "required": true,
      "defaultValue": "false",
      "helpMarkDown": "Select to have the Scheduled Task run on Wednesdays.",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "ShouldDateTimeScheduleFrequencyWeeklyRunOnThursdays",
      "type": "boolean",
      "label": "Thursday",
      "visibleRule": "ShouldDateTimeScheduleFrequencyWeeklyRunMulipleTimesAWeek = true",
      "required": true,
      "defaultValue": "false",
      "helpMarkDown": "Select to have the Scheduled Task run on Thursdays.",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "ShouldDateTimeScheduleFrequencyWeeklyRunOnFridays",
      "type": "boolean",
      "label": "Friday",
      "visibleRule": "ShouldDateTimeScheduleFrequencyWeeklyRunMulipleTimesAWeek = true",
      "required": true,
      "defaultValue": "false",
      "helpMarkDown": "Select to have the Scheduled Task run on Fridays.",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "ShouldDateTimeScheduleFrequencyWeeklyRunOnSaturdays",
      "type": "boolean",
      "label": "Saturday",
      "visibleRule": "ShouldDateTimeScheduleFrequencyWeeklyRunMulipleTimesAWeek = true",
      "required": true,
      "defaultValue": "false",
      "helpMarkDown": "Select to have the Scheduled Task run on Saturdays.",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "ShouldDateTimeScheduleFrequencyWeeklyRunOnSundays",
      "type": "boolean",
      "label": "Sunday",
      "visibleRule": "ShouldDateTimeScheduleFrequencyWeeklyRunMulipleTimesAWeek = true",
      "required": true,
      "defaultValue": "false",
      "helpMarkDown": "Select to have the Scheduled Task run on Sundays.",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "ShouldScheduledTaskRunRepeatedly",
      "type": "boolean",
      "label": "Repeat the Scheduled Task",
      "required": true,
      "defaultValue": "false",
      "helpMarkDown": "Select to have the Scheduled Task run repeatedly again after being triggered.",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "ScheduleRepetitionIntervalInMinutes",
      "type": "string",
      "label": "Repetition Interval (in Minutes)",
      "visibleRule": "ShouldScheduledTaskRunRepeatedly = true",
      "required": true,
      "defaultValue": "60",
      "helpMarkDown": "How long to wait after the Scheduled Task is triggered before triggering it again. e.g. A value of 60 will trigger the Scheduled Task every hour.",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "ScheduleRepetitionDurationInMinutes",
      "type": "string",
      "label": "Repetition Duration (in Minutes)",
      "visibleRule": "ShouldScheduledTaskRunRepeatedly = true",
      "required": true,
      "defaultValue": "1440",
      "helpMarkDown": "The maximum number of minutes to continue triggering the Scheduled Task for after it was initially triggered. e.g. A value of 1440 would allow the Repetition Interval to retrigger the task for 24 hours.",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "ScheduleStartTimeRandomDelayInMinutes",
      "type": "string",
      "label": "Start Time Random Delay (in Minutes)",
      "required": false,
      "defaultValue": "0",
      "helpMarkDown": "The maximum amount of minutes to delay the start time of the trigger. The delay will be a random value between zero and the number of minutes specified here.",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "ScheduldTaskAccountToRunAsOptions",
      "type": "radio",
      "label": "User To Run As",
      "required": true,
      "defaultValue": "System",
      "helpMarkDown": "The user that the Scheduled Task should run as.",
      "options": {
        "System": "System",
        "NetworkService": "Network Service",
        "CustomAccount": "Custom User or Service Account"
      },
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "CustomAccountToRunScheduledTaskAsUsername",
      "type": "string",
      "label": "Scheduled Task Username",
      "visibleRule": "ScheduldTaskAccountToRunAsOptions = CustomAccount",
      "required": true,
      "defaultValue": "",
      "helpMarkDown": "The name of the user or system account that the Scheduled Task should run as.",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "CustomAccountToRunScheduledTaskAsPassword",
      "type": "string",
      "label": "Scheduled Task Password",
      "visibleRule": "ScheduldTaskAccountToRunAsOptions = CustomAccount",
      "required": false,
      "defaultValue": "",
      "helpMarkDown": "The password of the user or system account that the Scheduled Task should run as.\u003cbr /\u003e\u003cbr /\u003eAs a best practice, a secret variable should be passed in here so that other users cannot see the password in plain text.",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "ShouldScheduledTaskBeEnabled",
      "type": "boolean",
      "label": "Enabled",
      "required": true,
      "defaultValue": "true",
      "helpMarkDown": "Select to have the Scheduled Task be enabled after it is installed; Unselect this to have it be installed as disabled.",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "ShouldScheduledTaskRunAfterInstall",
      "type": "boolean",
      "label": "Run after installed",
      "visibleRule": "ShouldScheduledTaskBeEnabled = true",
      "required": true,
      "defaultValue": "false",
      "helpMarkDown": "Select to have the Scheduled Task run immediately after it is installed.",
      "groupName": "ScheduledTaskSettings"
    },
    {
      "name": "ComputerNames",
      "type": "string",
      "label": "Computer Names",
      "required": false,
      "defaultValue": "",
      "helpMarkDown": "A comma-separated list of computers to connect to and install the Scheduled Task on.\u003cbr /\u003e\u003cbr /\u003eLeave blank to have it run on the agent\u0027s local computer.",
      "groupName": "ServerSettings"
    },
    {
      "name": "Username",
      "type": "string",
      "label": "Username",
      "required": false,
      "defaultValue": "",
      "helpMarkDown": "The username to use when connecting to the computers and installing the Scheduled Task.\u003cbr /\u003e\u003cbr /\u003eLeave blank to use the identity that the agent is running as.",
      "groupName": "ServerSettings"
    },
    {
      "name": "Password",
      "type": "string",
      "label": "Password",
      "required": false,
      "defaultValue": "",
      "helpMarkDown": "The password to use when connecting to the computers and installing the Scheduled Task.\u003cbr /\u003e\u003cbr /\u003eAs a best practice, a secret variable should be passed in here so that other users cannot see the password in plain text.\u003cbr /\u003e\u003cbr /\u003eLeave blank to use the identity that the agent is running as.",
      "groupName": "ServerSettings"
    },
    {
      "name": "samplepathinput",
      "type": "filePath",
      "label": "Sample Path",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "A sample path which is relative to root of repo if empty"
    },
    {
      "name": "samplestring",
      "type": "string",
      "label": "Sample String",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "A sample string"
    },
    {
      "name": "samplebool",
      "type": "boolean",
      "label": "Sample Boolean",
      "defaultValue": "false",
      "required": false,
      "helpMarkDown": "If this is true, this task will fail if any errors are written to the StandardError stream.",
      "groupName": "advanced"
    },
    {
      "name": "targetType",
      "type": "radio",
      "label": "Type",
      "required": false,
      "defaultValue": "filePath",
      "helpMarkDown": "Target script type: File Path or Inline",
      "options": {
        "filePath": "File Path",
        "inline": "Inline"
      }
    },
    {
      "name": "filePath",
      "type": "filePath",
      "label": "Script Path",
      "visibleRule": "targetType = filePath",
      "required": true,
      "defaultValue": "",
      "helpMarkDown": "Path of the script to execute. Must be a fully qualified path or relative to $(System.DefaultWorkingDirectory)."
    },
    {
      "name": "script",
      "type": "multiLine",
      "label": "Script",
      "visibleRule": "targetType = inline",
      "required": true,
      "defaultValue": "# Write your powershell commands here.\n\nWrite-Host \"Hello World\"\n\n# Use the environment variables input below to pass secret variables to this script.",
      "properties": {
        "resizable": "true",
        "rows": "10",
        "maxLength": "5000"
      },
      "helpMarkDown": ""
    },
    {
      "name": "errorActionPreference",
      "type": "pickList",
      "label": "ErrorActionPreference",
      "required": false,
      "defaultValue": "stop",
      "options": {
        "stop": "Stop",
        "continue": "Continue",
        "silentlyContinue": "SilentlyContinue"
      },
      "helpMarkDown": "Prepends the line `$ErrorActionPreference = \u0027VALUE\u0027` at the top of your script."
    }
  ],
  "execution": {
    "PowerShell": {
      "target": "$(currentDirectory)/Code/Install-WindowsScheduledTask-TaskEntryPoint.ps1",
      "argumentFormat": "",
      "workingDirectory": "$(currentDirectory)"
    }
  }
}
