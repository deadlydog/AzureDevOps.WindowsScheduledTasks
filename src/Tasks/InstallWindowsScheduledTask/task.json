{
  "id": "86718630-D8A5-128F-9C17-1C99F7C7CAD0",
  "name": "InstallWindowsScheduledTask",
  "friendlyName": "Install Windows Scheduled Task",
  "description": "Installs a Windows Scheduled Task",
"helpMarkDown": "[More Information](https://github.com/deadlydog/VSTS.WindowsScheduledTasks)",
  "category": "Utility",
  "visibility": [
    "Build",
    "Release"
  ],
  "author": "Daniel Schroeder",
  "version": {
    "Major": 0,
    "Minor": 0,
    "Patch": 17
  },
  "instanceNameFormat": "Uninstall Windows Scheduled Task \u0027$(ScheduledTaskName)\u0027",
  "groups": [
    {
      "name": "advanced",
      "displayName": "Advanced",
      "isExpanded": false
    }
  ],
  "inputs": [
    {
      "name": "ScheduledTaskName",
      "type": "string",
      "label": "Scheduled Task Name",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "The full path of the Scheduled Task to install on the server(s).\u003cbr /\u003eIf the Scheduled Task is to be installed in a directory, the directory (or directories) must also be included in the path.\u003cbr /\u003ee.g. `MyTasks\\TaskToInstall`"
    },
    {
      "name": "ComputerNames",
      "type": "string",
      "label": "Computer Names",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "A comma-separated list of computers to connect to and install the Scheduled Task on.\u003cbr /\u003e\u003cbr /\u003eLeave blank to have it run on the agent\u0027s local computer."
    },
    {
      "name": "Username",
      "type": "string",
      "label": "Username",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "The username to use when connecting to the computers and installing the Scheduled Task.\u003cbr /\u003e\u003cbr /\u003eLeave blank to use the identity that the agent is running as."
    },
    {
      "name": "Password",
      "type": "string",
      "label": "Password",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "The password to use when connecting to the computers and installing the Scheduled Task. As a best practice, a secret variable should be passed in here so that other users cannot see the password in plain text.\u003cbr /\u003e\u003cbr /\u003eLeave blank to use the identity that the agent is running as."
    },
    {
      "name": "samplepathinput",
      "type": "filePath",
      "label": "Sample Path",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "A sample path which is relative to root of repo if empty"
    },
    {
      "name": "samplestring",
      "type": "string",
      "label": "Sample String",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "A sample string"
    },
    {
      "name": "samplebool",
      "type": "boolean",
      "label": "Sample Boolean",
      "defaultValue": "false",
      "required": false,
      "helpMarkDown": "If this is true, this task will fail if any errors are written to the StandardError stream.",
      "groupName": "advanced"
    },
    {
      "name": "targetType",
      "type": "radio",
      "label": "Type",
      "required": false,
      "defaultValue": "filePath",
      "helpMarkDown": "Target script type: File Path or Inline",
      "options": {
        "filePath": "File Path",
        "inline": "Inline"
      }
    },
    {
      "name": "filePath",
      "type": "filePath",
      "label": "Script Path",
      "visibleRule": "targetType = filePath",
      "required": true,
      "defaultValue": "",
      "helpMarkDown": "Path of the script to execute. Must be a fully qualified path or relative to $(System.DefaultWorkingDirectory)."
    },
    {
      "name": "script",
      "type": "multiLine",
      "label": "Script",
      "visibleRule": "targetType = inline",
      "required": true,
      "defaultValue": "# Write your powershell commands here.\n\nWrite-Host \"Hello World\"\n\n# Use the environment variables input below to pass secret variables to this script.",
      "properties": {
        "resizable": "true",
        "rows": "10",
        "maxLength": "5000"
      },
      "helpMarkDown": ""
    },
    {
      "name": "errorActionPreference",
      "type": "pickList",
      "label": "ErrorActionPreference",
      "required": false,
      "defaultValue": "stop",
      "options": {
        "stop": "Stop",
        "continue": "Continue",
        "silentlyContinue": "SilentlyContinue"
      },
      "helpMarkDown": "Prepends the line `$ErrorActionPreference = \u0027VALUE\u0027` at the top of your script."
    }
  ],
  "execution": {
    "PowerShell": {
      "target": "$(currentDirectory)/Code/Install-WindowsScheduledTask-TaskEntryPoint.ps1",
      "argumentFormat": "",
      "workingDirectory": "$(currentDirectory)"
    }
  }
}
